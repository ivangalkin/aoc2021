#ifdef NDEBUG
#undef NDEBUG
#endif

#include <assert.h>

#include <iostream>
#include <string_view>
#include <tuple>
#include <set>
#include <map>
#include <algorithm>
#include <sstream>
#include <list>

#include <regex>

#define myprint(arg) std::cout << "" #arg << " = " << arg << std::endl;

using namespace std::string_view_literals;

static std::vector<std::string> input_real = {
        "vvvv.>>...v....v>....>...v.v....v>>v>v..>...v>>>v>.>v.>.>>......>.>..>vv.vv.>>vv>..>.>v...>...>.>.v>..v>>v>>v>>.>.>..v..>v.>.v....v..v>>v>>",
        "...>....>..v......>v>......v.v...>.v>..>.>>..v.v>...v.>v>.v.>.vv.>>>.>v...vvv>>.vv..v.>v>.>....>>.vvv....vv>.v.>.....vv.v...>>>vv..>v>.....",
        "v...v>v.vvv..>.vv.v....v.>>vvvv>v.vvv....>.>v.vv...v...>>...v.>....>.>>.v.>......>v>.vv.>..>>v.vv>.v.>.vv>..v.v>>>>vvv..>v........>vv>..>v.",
        "...>..v>v>v>v.>v..v.>v>>>.>>.>>vvv..v...vvv.>.v>.v..v.v...v...>>v>>....>>...>vv.>v.>>.>v>..v>vv>....v.>...>.v>..>.>>.>v...>.>v...>....v..>>",
        ".>.....>...>>>>..v.v..>.>>v....>v..>....vv..>.>.>vv..>>v.>.>..v.vvv.>.......v.v>v>..>.v...>.v.v>v..vv..vv>..>.vv.>.vvvv>..>v.>>vv...>.v>v.v",
        ".vv>.>.vv>>vv..vv>.v..>>>v..>.v>..>v.....>v.v.>..>v..>>v...v.>>.v.v...vv.....>..>>.....>>.vv>.....>>>.>v>...>v..vv.>..>>..v...v..v..>...>..",
        ">>....>...v..>>...>>>.....v...>>.>.v.>vv.>..>vv....v.v.....>.vv..>>.v>.v>v.>>......>>..>v...v...>...v.>v.>v>.v.>..>v.>....>>v.>>.>.....>...",
        ".>>vvvv.v>>>>vv.v>...>v...vv.vv.>>v.....vv..v>.vv..>.v.>..>....v...v...v..v>.v.v.vv.>vvvv>..>..>.>.v.v.v.v>...>v..vv>.v>vvv..v.....>>.v>>v.",
        "..>.vv>..>>.>.>>>...v.....v.....>>>..>..>>.v...>>>>..>>.>.>>..>.>......v.v>v...v>.v.v.>>v>.v......>v..v.vvv>>>v>....>v..>>.v>vv.vv.>.v..v.>",
        ".v.v....>vv......>>v....>vv......>>.>....v..>vv>v..>>>.>.vv.....vv.....v...>v..v...v.>.>v..v.>.....v.>.>>.v...>>.>.>.v..vvv....>>>.>v>vvv..",
        ">>...v>>..>..>.vvv....vv..>vv..v.vv>.vvvv>>>..>>>..>.>..>....>v>.>v......>vv.>...>..>vvv..v>>.>v..>>>.v...>v.vv>..v.v..vvv....v.>>.v...v.>v",
        "...>>>>vv.>..v....vv...>.v..vv>.>>...v>>.v>......>v.v>.vv.....v.>..>>>.>v...vv..>..v.>>...v>..vv.>...>v....>v...>..>..>.vv>>.>vv.v.v>.v..vv",
        ".v....vvv>vv.v.>..v>..>.v.>>v..v>..v...v.vv>>....v.........>..vv..>>...>v..>.>v.v>>v.v>>>...v>.v>.v.v..v>....>.v..vv.vvv>>>.v.v>.>v.v>>>.>.",
        "..>>v>>.v>vvv.>>......v>>.....>>v>.>..vv......>>.vv>...>.>.>....>.>.>>.v....vv>v...>..>.>>>.v.>...vv...>>.v>>..>.v>...vvv>v.>.>..>.v>....v.",
        ".>>....>v.>>>>vv>..>..v...>..v>>.>v..v....>vvv>>>>vv...vv>v>v.>>vvv>>>v..>>>>.>.>.>.v.v.v.v>.v>.v...>..v..>.>>v>.>.vv...v..v>.v..vv...vvv.>",
        ".v.>v..>..v.v.v...v....>.vv>>v.vvv.>vv>>.v..v..v>v..vv.>>vv>>.>>v...v.>.>..>>>.v.v.>..>>..vv...>.v.>>...>v.>vv...v...>vv.>..>v.v.vvv>.v..v>",
        ">..v>.v..v.>v...vvv.vv...>>>.>..>vv>.v>..v>v.v..v.>....>>..>>.>>>..>>>>>vv...v.>>.>v..v...>.>vv..>.>..v>>..>..>>.v>....v>>v.v.....>>...v...",
        ">.>.....>..>..vv..>v....vv....>v.>......v>.>vv>vv>..vv.v.....v.>>>>..>>v.>.>....>v.>.....>...v...v.v..>.v..v>>.vvvv.>..>v..>.>vv..vvv..v.v.",
        "..vv..v...vv.>.>.v>v....v..>vv.>v...>>v...vvv>vvv....>v>v>.......>>>.v.v...v...>.>v..v>.v>>...v....v>.>..vvv>>>.vvv.v.v>vv>.vvv>..v>.....v.",
        "..v.....>>..>>v>>..>.v.v.vv.v....vvv.vv.....>v>.>v.>.vv....>....>v>...v.v...>>.>....v...vv.>....v>..v.>>.v...vv.>..v.v..>vv..>..v>>v..v.vvv",
        "vv>vvvv..vv..v.v.>>>>.>>>>>v>v..>>.vv.>>>..>....v.vvv>.v.v..>>.v>.>>v.v...>.v>>v.>>.vv..>>>>vv..v>>v>v.v...>.....v.v>.v>>.>.v...v..>...v...",
        "...>..v>v..v>.....v.vvv.vv.>>>..>>>>.v..>..>v.v.>v..v.vv..v>.v.>.>v.....vv>.>>..>.vvv...>>...>.>v.>.v>.v.v.vv.>>.>v..>..vv.vv>>>..v.v>...>.",
        "....v.v>.>v.v.>>>.>.v...>vv.....>.v>v.....>.>.>>>v.v>....vv>vvv...>..>..v..>vv>v.v>>v.>v.v.v>.vv.v..vvv..>.v.....v.>.>>.vv.vv..v>v.>.>..>.>",
        ".v.>.>.v.v..v..v.>v..vvvvv.>.v.>>v......v...>.>.v.>v..>..vv.>.>v..>..>>v>v..vvv...v...vv>..v....v....>....v.>>.v>>>..>..v.>.v.>v.>....v....",
        ">v.vvv>>..v>>>>.v.v.v.v.v.v......>v..v.>>vv...>..>.v.....vv>.>v.....v.v.v>>>..v..v...>vv>..v.....>...vvv>...v>.>..>....vv>.v>.....v.v>.....",
        "....>..v>.v...>..>..>..v.>..>..v.v......>.v>.v..v>.v>..v..v>.v>.>.v..>..>v..>.>>..v..>vvv>..vv.>>.>v.v.>.>vvv.>..>......>v>.v.v...v>>.>>>.>",
        ".>vv>v>...v...>..>.v...>>...v.v>>..>.vv....vv...>.>....vv.>.>.v.>>.>v>...v.v..>..>>...>...v.v.>v..v>..v>..>.v...v>.>.>vv.v>..>v...v....v.v>",
        ">v.v.>.v>>..>v.v..>>..>v.v.>v..v>v.vv>...v>>.>v>v.>v..>>..>....v.vv>vvv....v>vv.vv>vvv..>>........>>>.v....>>.v..>.v....>.v..>..v>v......>.",
        ".>.v..>.>>..v.vv....vv..v..>.>.v..>...>v...>v.>.vvv>>v.vvv..v.>.v...>>>v.vv>>>v.>>v.v..>v.v..v..>>..v......v>v>v.v..v.>>>.>.>vv.vv.v>..v..>",
        "v>...>>v..>....v>>>..v>>>.vvv.>.v..>..vv.>...v.v..v.vvv...v.vv.v>...v........v>v.>v.....>>...>v.v>.>...>>.>>.>>v.v>>v.v..vvv..vv.>..>.v>..v",
        ".vv.v>...>>>..>.>v>.>.>..v.vv.>..v>...v>.v..v...>vv.>>v...>>.>.>.v.>.>.....>v.>.vv>.>.v...>...v>.>v.>.v.>>v.v>..v>.v>.>.v.v.>v.vv>>>.v.vv>>",
        "v...>...vvv.>>>vv.>v.v...>>>>v>>>.vv.>..>.>vvv.v.>.....v..>>>v>..v>....>.>>.>..v...v>.>>..>..v.vv..v.v.>vv>..v..>>>.>>>v.>...>>..>>v.v.vv..",
        ">..>..vv.vv>...>>..>v....v>v..>.>....>>>...v.>>.v>...>..vv.....>>.>vv..>.vvv..>>>.v..v>>>.>v..v>..v..v>..v.v.vv.>>vvv..v>.>>..>v>vvv>v>>v..",
        "v.v>>v....>.....>v.>.v.>v..>.>.v.>v....vvv.>....>>>..>.>.>.>vv>.>v..vv..v..>.v>vv>vv..v.v...v..v......>>..v.>...>>vv.>v..>v.>.>>v.>vv.>.v..",
        ">..v>..>vv.....v.v...>.vv..>.>vv>v......>...>.vv.v..v..>.v.v>>..v.>..>vv.>.>>vvv..v>..vvvv..v.>v>vv.v..v>>>>v>vv>.>.>>.v>v.v.>..v>.>v.v.v.>",
        "vv..vv>v..v..>vvv......vvv.vvvv>>.>.v.v...>v>...v>..vv..vv>>v>.v.>>v.>>.vvv.v...v>>..>>>v..>..>.....v>>.>>v....>.v>.v>.v..vv..v..>.....vv>v",
        "v>..v>.>v.>.>>>v.v.vvvvv>v.v>..>.vv>...>>..v.>v.>v....v>..>v...v>.>>...>v..>>.v..>>v..v..>>.>.vv.v..>.>>v...>.>>......v>>.>vv...>.>.v..>...",
        "..v.v....v.>v>.v>v.v...>vv>..vv..vv...v>>>v...vv>.>>..v...>v....v...v>.v>>>.v....v..>v.v....>.>..>.>>v.v.v>.>.....v.>vv.>.vvv.>v>>...v...v>",
        "vv>..>..v>>>v>.v>v>...>.>>.v..>>>>..>>.v>v.vvvv..>.>>v.>v>>>..>>...>>.v.....>..>.>vv.vv.>>>.>>v>v..vv>vvv.>v.....v>.v>v.>>.vv>>.vv.v>...v.v",
        "vvv..>..vv..vv>v.>vv.vv.>.>.>..v>.vv.vvv>v>.v.v>.>>v..vv.v...v.>..>.vvv>...>v..vv.>v..v...>.>..v>v.vv..>..vv.v>v.vv.v.>v.....>>>.......v..>",
        "v......v.>>>>...vvv.>..v..>.>>v....vvv.>>.>...v..v.vv.>......>..>......vvvv.v..>.......v..>>..>>>v.>>>..>.v...>vv.v>>...v>>.....>>vvvv..v>.",
        ".v.....>...>.>......>..vv>..>....v>v.>.v.v...v..v>.>..>.>.v>v.>.>v..v...>.>v.>.vv.v>v.....>v....v.>v>..>.v...v>.>.>...v.v..>v..v..v..>v...>",
        ">v.>>>.>.v>.>v....>>..>....>.v.>>>...vvv.>.v...>v>.v..>..vv>..v>.v..v...v..>..v.>v>v.......v.>.....v>.>v>v>..v.v>.>>....>v>>.....>>.>v..vv.",
        ".v..v..v.v>..v..>..v.vv.v>v>>..v>.v....>v......vv....vv.vv>>v.v....>..>..>>.>vvv.v.>.>.>v.v>>v.>>>.vv.>v.>.....>..v..v.>.>..>.v.>>.>v.>vvv>",
        "...>...v.>........v....>v....>..>.>>..vv.....v>vv.....>>.vv.>..v.v..vvvv>vv>...vvv..v.>..v...v.>>>..>>.>v..v..vvvv>>.>.>v.vvv.vv.v....vv.v.",
        "v..v>..>>.v.>>.v.v>.>.v>v..>>v.v>v......>>....>...>.>>.v>.....>>>>...>..>>.v.v>.v.v..>>v>.>.v.>...>....>v>v>vv...v.......vv>.v.>>.v>v.>>v.>",
        ">.>v.vv>vv>>v>.....v>...>.....v>.v.v.v.>>>.v....>..vv.v.>>..>..v..vv.v..v.v>>....v>..>..vv>.vv>..v.v.v.>.v.>v.>........>>>>.v.>..v..v>.>.>>",
        "...>..>.vv.>...v...v.v.v.>...v>.>...v.v..>.>vv.>..vv..>.v>.vv.vv>vv..>>v.>>v>.>.v>v....>.v.>vvv..v..vv....v...>.v>.>.v>vv.>>....>>.v>>.v.>.",
        "vv..>....vvv.>..>.v.v..>...v>..vv.vvv>.v>.v.>..>vv.v>.>...>.v.>.>>>...v...v...v.v.v.>v>v>.>.>v.>v>.v>..v..>v..v>....v...>..>.....>v>..>>vv.",
        "...v.>..>.....v.v..vv....v....v....>.>>..v...vvvvv.v.v...v..v>.>.v..>.>..v.....v...>.>v.>.....>..vv...>>.v.v.>>.>>.v>>>>>v.>>...v..v.v...v.",
        ".....v..>.>..vvv..vv>vv>>....vv..vv>>v.v>...>v.v.v>>.....vv>...>v.>...>.v>v...v.v.v>>>>>.vv>v>v...v>..v...v..>.v>v>>>vvv..v.>.>>>...v....v.",
        "v>>>.>v..v>.vvv.v..vv.>v.>..vvv.v...>.vv>.v.v>>...>v....v>.v....>...>v.v..>...v>>...>>>...v..>v>...>.v>.vvv>v...>..>>>vv>.v..vv>>>..v...v.>",
        ">...v>>..>>....>.>v>.>>v...>.>>>vv...v.>.>.......v...>>.....>.vvv>...>>.v>vv>...>.>v.v.>.v.v>v..v>vv...>.>>...>.....>.v..>vv.>>.>>.>...>...",
        ".v...>vv>...vv>v.>....>>.v....>....v.vvv>>..v>....>.>>....>v.....>v>.v..>v>vv..v.v>.>v..>vv>..>..v...v.>.>>...>>vv>v>v..>......>.v.v>....v>",
        "v...v...v>>v...>vv...>vvv>>v..v....>.....>v>.>>v>..v.>.>>>>.>.>.>...>v>>.vv.....v>..>>>v....v....v.>......v...v>v>>..>...v.>>..v.....vvv>.>",
        "v>>.v>v...v.>>v.v>>...>.v.....>vvv.>v...v>.v.v>.v..>v.....v.>v..>>v>v.......>v>v.v>.v>vv>v..v..>>......vv..v.>v.vv>.vv.v.>v..>.v>vv.v>.>.>.",
        "v.vv>..v.v...>vv>>..>...>>>...v...v.>v>>>>v>vv.v..v.v..v>>v.vv.>>.v.>vv..vv...v..>vvv>>>.vv..v.v..>.v.......v.v.v..>.v>..>>v>.>v.>vv.v....>",
        "v..v.>..>.......v>>v..v.>.....v.v....v..>.v.v>v...vv..>.v>.>vv>v..>v>>.>...>......v>...vv.v.v...>>....>v>...v...v..>>vv.>>.v>..v.>>.v.v....",
        ">v>..>>...>v>.>..>>..>vv..>..>v..v.v.>>..v.>v.v>>vv.>>..>.vv.v.v.vv...>>...>>v>.v.vvv....v..v.>.v>v>>>v>.>...>vv>...>..>>>v.v.vv....v>>v>v>",
        ">..>>>>.....>v.>...vvv..>..>...>....v.vv.vv>v>vv...>...v>>..>>v...vv..vv>..>>.v..vvvv>..v....v....>vv.v>...v.v..>v>......>....v>.>..>v>...>",
        "..vvv>.>..v...v..>.>v.>.......>.....>v>...v>.>>>>>..v.>...>vvv.v..>vvvvv.>.>v.>.v......>v.....v>v.>..vv.>.v>.......>.vvv.>>.v>.v..>.>v.v.v.",
        ".....vv>.v>v.>>v..v...>..vv>.v.>v...>vv.>...>...>..>..>>.v.....v..v...vv...v>.>.....v...v>.vv>.v..>>v>....>.>>v.>vv>.v..>..>......vvvv..>.v",
        ".v>..v>..>.....vv..v>..>....v..v.>v>....v.>vv>v.....v....vv..>.v>..v>.vv>>>.>>..>v..>>..>>....>.v>>>>v.>.v..>>........v.vvv>v.>..>v>>>v>v..",
        ".>vv.>.....v..v..v>.v...>v>v.vv..v>..vv..>.>v...>...v.vv..>...>..v>>.>v.>>.v...>>>>v.v..>>.v.v...vvvv>.v>v...v.v..>vvv>...>>..>.>v>>>.v>>..",
        ">..v>>v.v>...v>vv>...v>vv..>vv>>.v.vv.vvv.>.>v>>v...>.v.>v..v.>..v>..v.vv.....v.>>.v.>..>....>>....>..v.vvv>>>>..>....>.v>......>...>>>....",
        ">.>vv.>v>v.>.>.>>..v..>..>.>v......>..>...>v.vvv>>v...>..v........>.v>...>>...v>.....>v.v....>v.>..>.>vv....>....v.v..v.v>.vv>>..v.vv>.>.>.",
        "v.>.v.>v..v>.>.......>.v.>>.v..>....v>.v.v>.>..v..v.>>v...v...v>....v.v.>>v.>.>.v.>.>v>v........v.vv>.v...>>...v.v...>v..v......vvv.v.>>.v>",
        "v.v>v>.>.vv.>..>>.>v.v..>....>.>.>v.>v........>.vv....>>>>vv>..>.>v>.v.>>v>..>>.>>.>...v.....>.v>v>..>.v>.v>>>v.>>>vv.>.>....v>>v.>.>.>.>>v",
        "..v..>..>......v....>....vv..>..>...>.v.....>>.vv...vvv..v>.>>v>>v..>.vv.>>.v.v>>v>>>>>v>.>>.v>.>v>...v..>...v..>.>>.>.>.>.v.>....>.>.v....",
        "..v...>..>v.v.vv....v.>.>vv.v.>.v.>>v.vvvv.v...>>v.........v>>.>vv>..vvv>vv.v>>.>vv>v.>.>.v.v..>v>.>v.vvv....vv..>.v..>v.>......v.v>..>..v.",
        "..vv>v>..v>>v.v>.v.>vv.vv.vv>....>.>>>>.>......>...v.>.v>...>..>.....>.>...>.>..v>.>v..vv>>..>>..>>.>>.vv..>>v>>..v..v>.v..>...>v.v>>..>>>>",
        ".v.v.>.>...>...v>..v>...>.vv..v..vv>>....v..v>>>.>...>v>.v..>vv.>.>>>....>v>....>>>v.v.>..>..>>..v>>.v.vv.v.v.>vv>v.....v.>..v..vv>...v.>>.",
        "..vv.v.>v...>v.....v.>v..v....>v>>.>.vv.>.>.>....vv.....>>vvv.>.v>>>.v.>v.vv.v....>..v..>v>v.>>.>v..>.>.>.v.>vv.vv...>v>....>v..>.v>.>>....",
        "vvv....>vv>v.v>>>.v>vv..>v.v..>vvv>>.v.>>v>>.>vv>v.v>v.v.>..v.v..v>>v........v.vv.>.v>...>..>...v>>.>.v.....v...vv.vv>.v.vv>>.v>v>v>vv.>>>v",
        "..vvv>...vvv>>.....>...v...v>.v..>>v>>vvv...>v..vvv..>>..>>.>>>>..vvv>>vv>vv>>...vv.>.>v>>>.>...>.>.>.v.v..>.>>...v.>>..>>>.>v>>.vv...v>>..",
        ".>>v.vv.v.>v.>....>.v.v>.vv...vvv..v>.v>>>v>>.>..v.v...v>.vv.>.v..v..vv.>.>.>.>....v..v>>v.vv.>.>v>.v....>v>v..>.v.>..>.v>v>>v>>v>v.>.v.v..",
        ">.v>.v..>...>v...>...>.>>>v.>.>v>.v.>vv..v..v.v..>.>.>>>v...v.........>..>>vv...v>vv..>v>>.v..>vv....>..>..v>.vv.>v..>v>>>.>>v.vvv.>..>>>v.",
        ">vv..>.>...>.>.>>....v>vvvv>...v.v.>..v>vv>>...v..>>..>>>>v.>v>...>>....>v>v>..vv....>>....>>>.>..>.>.>.v....>v>..v.>.>>>....>vv.>.>v.>v..>",
        "v>...>..>.>>>.v>>v.>>.>...vv.>..vv.....v........vvv>>..>>>.>.v>.>v>>v>v.v...>..v.v>..>...>>v>>.....v>.>>v>...v.>.v>....vv>.v.v.vv.v.......>",
        ".v>.v.vv.v..>v..v...v..>.v>.v..v>v>......>>>.>..v>..v>vvv.v.vvv.v..>.......>..>>.v.....>...>>>..v.>>>>.>.>v>.>.>..>>vvv.....vv.>.v.v>.....>",
        ">v..>.v......v.......v.>>>v.>vvv.......>v>v...>>vv.v.>.....>v.......v>v>>..v>....v..v..>.>...>v>..v.>.>v>v.>....>v...>...>vv...vv.vv>>v.>v.",
        ">v>.v..v..>v.v....vv.v.>vv.>.>>.vv......vvv...>v>.>v..v>...vvv.....>..>.>v>.>.v>.v.v..v.>.v>.v...>v>v.vv..>.>>.>..>...>v.>>v>..>v..>>..>..>",
        "..>>..>v>v>...vv>..v...vv..>.>v.>>>.>v..>..v>....>....v....>.v.v>>>v.v>.vv.>.>>v.vv...>vvvv.v>.>>v>>>...v>..>.>>..v..>>..>..>.v>v..v...>.v>",
        ">v>v..vvv.v.v.>.vv..>.v>.v.>.v>..v..>.>>.>v.>v.......>..v.v.>..>.....v>.>..v>>....v......>v..v>>v..v>>...>>.>..v..>.>>...>.v.v..v>>.>>>>v.v",
        ">.>>..v>v..vv.>vv.>..v..vv>>v...>...>....v.vv>v...v.>.>..>>>v..v......v>v.v..v>v>...>vv....>v>v.>>>.v.v>.v>....>v...v.>vv..v>.>v.v..>...>.>",
        "v.v>.v..>.v...>>..v....>>.v>....vv....>>>..>..>>>v.>v>.....v.>.vv.>....v.vv.vvv.v.v>.vvv....>.......>.v>v>>..v>.vvv>.>vvv.v.>...v.>v>.v>vvv",
        "v.>..v...vv>.v.>...>.vv>v.>..v>...v..>v....vvv..>.v.v.vv.>..>...v...>v..v.....v.>>v....v.v..>.>..>vvv.>..>..v.>..>..v.>..v.>....v..>..>>...",
        "vvv.....v>v>v>>>.>...>..>>v......>..v>.>>vv..>>...>.>>>>v>..v.......>>.....v..>v.v.v>>>>...v.>..v.....>.>.v..v>v.v>>>>.>>>...>.v>.....>.>v.",
        ".>..vv...>>.v>v......vv.>.v>>v...>...v..>.>>.v.v>...>vv.>..v..v...v>>>>>v>v.....>..vvv>>.v...>v.vv>..v..>>...>.>>.v..>>>..>.v>>....v>>>....",
        "....v>vv>>.v..v..>>..v..>.v..v.v.>......v>.v...vvv>v>>.>..v.>>>.v>v.vv.v.>.vv...v...v.>vv>>..>..v>v>>vv..>>>v>..>.vv..vvv.>...>>vv>.vv>.>..",
        ".>v>>.v>...>..>...vv..>>vv.vv.v.v.....v>v.......v>>.v.........v.>>..v>.vv..v.>.>.v.>>.v>.v>.>.vv...>>...>.>>..>.v...v..v.>v.>>>v>.>v......>",
        ".vv>.>.>.....v.>>.....v..>vv.....v>v..>...v>..vvv>>vv.>v.>v.........>...>>>.v...>>v.>v.v>>......vvv.v..vv.>.v>.v>>vv>v>v.>vvv.>v..v......vv",
        "..v..vv..>>>>vv>>>>v>.v.v>v..v.v>.v>v>>.v..v>v>>>.>...>.v>vv.v>.>>..vv>.>.vv.....v.vv..v>.>.v......v..>v>.>...>>>>..v.v>.vv>...>.vv.v>...>.",
        "v.....v...>.....>v.v.....v.vv...vv>.v>.>>..vvvv>.....v.>.vv>...v>..v...v..v>.>.>>..v.v..>>>>.v..>..>.v>>>.v>v>....>.>>.>>>.....v>.>>v.vv...",
        ">vv...vv.v...v..vv..v.>v>.>.vv.v...vv>>v.vvv.>>.v..v.>......vv>.>..v.>.>vv>.v.>>.>.>v..>>.>>v.>v..v>>...>>....>v....>..>>...v...>>..>....>v",
        "v>>.....>...>v.v..>.....>.>>.v>>..>v.v...vvv>v.>....v...>.v..>.>v.v>...v.v.>.>>...v....>vv.>>>......>v.>v>v>>..v..>v>..v>vv.....v..>>v.v>v>",
        ">.>..>v>v.>v..>v>..>.vv.v>>v.v....>..>.v.v>>v>.>v.>.v>v>.>>.>v.v.v.>.v>.>..>>>>>..>.>..>>.>.>...>>..>>>..>.v.>..>vv.>>.>.v.>vv.v.>>.v...>v.",
        "...>vvvv.vv>.>.>vv.v>>..>.v>>..vv>>.>v.>>>>.vv>v.v.>v..>vv...>...>..v>.........>.........v>>.>....vvvv.v..>v...>>>....>>v..>v.vvv>.v....vv.",
        "....v>.vv>..>>>v.v...>v.v.vvv.>.>...>..vvv>v..v....v>.>>...>>.>v...v..v>v.vv>..v.vv...vv>v..>.v>v.v.v.>v.>.>vv.v.>v..v.....>.>v>.>..>..>.vv",
        "..>v>>.>v.v.>>v.v>.>>>>...v>>v.vvv.>>.>..v>v...>.v>..vv>>.v>.v.>....>v.>.....v..v.>vv>>>.>.v>>..>.v..>.vv>..>...v.v..>>.>.v>....>v>>v.v>..v",
        ">..v.v...vvv>...>v.vv.v..>.>v...v>.>.vvv....v>.>.>.>v>>....>>...v.>>>..v>v..>.v.v..v.vv>...>..v>>.vv.v>..vv..v....vv>>..>v.v..v>>v.>..v.>..",
        "....v....v>v.>.....>vv....v.v...v>>>.>.v....>......>v...v....>v..v>v..v....>>>>v>>.>..v.v......v>.v....v>.>..>.>>v.>>>...v.vv.>vvv.v.vv..vv",
        "..>>..>v.v.>v.v>v.>>.....v........vv.>v.>.vv.v...v.v.>.>...>v.>>v...v.>.......v..>.vv...v.>..>>v>.v...vv>v....vvvvvv>...v.v>...>..>..>>>v.v",
        "...>v.....>v>..>v.>v.>.v>.v.vv.v>.v>..>v>>.>>v..>..v..>.>v....v.v.>>>.>v...>>>>..v..vvvv.v>vvvvv...>...v>v>>.vvv..>.v...v...>>..v..>.v...>.",
        ".v...v...v..>.v>.>>..>...>>.vv>>v..>v..>v>..v.v.>v.v>.vv..v.v.>.>v..>..v..>...v>v>v.>>..>v.>>..v.....>..>.....v>..>>.vvvv.>.v>.>>>>v.v>....",
        "v.v.>v..>..>v.v>.v..>>....>>vv>v...>>..v....v........>v>v.>.>.v.>.v>v>...>>.v.v>vvvv.>..>>v>..>.v.v>.v>..>...v>.v>v>>v.........>>.vvv..v.v>",
        ">>.>.v.>.....>v>.......>v.v.v>.>v..v....>v...>.v.vv...>.>.v...v>..v.v>..>.v.v.>v.>.>.>vv>.>>vv..>v>>..vv.v..>v..>..v....>v>vv>v>>>.>v..>.v>",
        "v.....vvvv>...v>..vv.>vv..vv.>vv...v>>>...vvv....>>v...v....v>.>vv>.>>>vv>>>>....vv..v>>>>..v..>.v...>.v....v...>v>.>.>>>v>...>..v.v..>>v>v",
        "...v>v.>v.>vvvv>..v>...vvv.>......vvv..vv>.>.....>>.vv.>.>.>>..>>>>>..v>v.vv.>.>>vv>v>>v>..>..vvv.v>...>.vv...>v.>..v>.v.>.>vv.v.>...>vv..>",
        "....v.vv.>>...v.vv>.>>>.>..>..v>vvv.v>v.>>>...v>v.>.vvv.>>...>.vv>>..v.....v..v.>>.v>....>.v..>.>v.>.v....>.>.v..>v>>>v.>v.v.>v>vv.>.v>.vv.",
        "v.v>.vvv..>>v.>..>.>..>..>..v>.v.>v..v..>>v>>v.v.v.>..>.vv....v>>.v.>....>.>>vvv>...>.v.v>..vv.>.v..>v....v....vv....v.>..>.v>....v.....v.v",
        ".>..>>vv>>.v>>v..>.v>>..vv.v>>>.>>>v.v>..>...>..vvv..>vv.>v>>>.>>>v.......v....v>v.>v.vv>...>...>>...v>v>..v.>>..v..>>>>..v.......v>.....>>",
        ".......v>.vv.v.>>v.v>v.....v.vv>v>>....v>v..v>>v.v...v>...v.>v..v..v>v......>.>.>...>>....>.v...v.v>v.v...vv>...>>...>.>.>>.>>.>.>..v.v...>",
        "v.>.>v..v>>.>>.v>.v.>>v>v..>v..>..>.....v>....v>>v>.>...>v.v..>vv.>vv.>>...v.>..vv..>...v.>..v......v.>...vv>v>>>>vv.>vv>.>.>...>...>>vv.>>",
        ".>.>v>>.>.v.>......v.v.>v>>v..v.v>....>.....v.>.v.>.>>>v.v>>vv...v..v>>>>.v...>>>.vvvvvv..>..>..>vv>.vv.>.>.>..>>vvv.v.>....v>vv..>vv>v.vv>",
        ".>>v..v>...v......>.>..>v..>.....>.>v..vv.v>>vv>.vv...>...v.v>....v>...>.v>>...>.....vv>.>vv>..>.v.>.>v....>v..>..v>>>v.>...>.>v.>.>v.v>.v.",
        ".>v.>>v.v....v.......>.v.v.v..>v....>v>.v>.>v>>..>v.v>>.>>.vv>>vvv.>v>v.....>>vv.v.v.v.....>.>.vvv>v>...>..v>.v.>>>>>..>v>.>v.>>v>>v....v.v",
        "vv..>.>>.>.vv..>..>...v.....v....>.v>v....v.vv.v...>.vv..v>>.....v.>......>.....vvv..v>v>.v...v>.>v.v..>..>.>vv....>>.>>v>.>.v..v>vv.v>.v..",
        "v>.v...>v..v..vv>>v..>v.v>.vv>>..>>>.v.>.....>v..>v.>v....>vv...>.>>>.>>v.>.>v..>.>v.>>..>v...>>.>.>v..v.v.vvvv....v.v>.>..>>>..>vv>...vvv.",
        "v>>.....>vv.>....v>.>>v..vv.>vv...>v>.vvv...v>...v.v>.>...v.>.>>v.v..v>.....vv.>..>>.vv.>..>.v.>v>..v.vv.v.v...v.v..v>.v.v......vv>...>..>v",
        ".>...v.>.v..>vv...>.vvv..>>v..>..v.>.....>......>>>.v.vvv..>>...v>.>.vv.v>..v.vv>vv...v>.vv>..vv.>...v.v..v...v..v.>...vvvv.>..vv..v...vv..",
        ">..>>>.v>..v......v.>.....>v.>>>..>.>>..>>v.>>vv>.>....v>v.>.v..v>..>..v..>v..v....>>>>...vv..>...>.......>.>.v>....v.v>>.v.>.>v>.>>>v..>>>",
        "..>.>vv......>.v>>.vvv>..v.v.>.v.>>>>.v>>v>......>>>>.>>.....>.>..>.vv..v.>..v>>vvv.v>...v..v.>.v..>.....v>vvvv.v.vvv>.>v..v>>.v>v...>..v.>",
        ">..>..>..vvv.>.>.>..vv>....>v>.v.>v.>>>...>>.v.>.>.>.>...vv..v>..>vv...v>..v..v.>..>.>v>......v.....v.v.vv...>v...vv>vv.>>.v..v..v.v..v...v",
        ".>...v..v...v.>..v..v>v.v....v>.vv.>.vvv.v.>>.v..vv...>>..v.>>.v>.>.>..>vv>vv.v...>.v>>........>.>v>...vv.vv>v..v>.>.v.>v.v..>..vv>.v..>...",
        ".v.v>...>v....v....>>>vv..>>v..>....>vv.>.>...>>..v.....>v.>.>...v.>v.>v>..>.v.>.....v.>>>v>>>v..v.v>>>v.>>..v..v....vvv..v>>.>>>v......v>>",
        "..>.v.>>>.v....>..>vv...vv>>.>v.>>..v.v>>>.v.>v>.v..>>>....>vv................>>>.>.>..v>...>...v.>>.v.>>>.v....>>>.......>v>vv.v....v...>.",
        "vv.......>v.v.v.>..vvvv>.>>vv...>..>.>>v...v.>v.v>.>..v.....vv..v..>.>>....v..vv.v.vv>..vv>v>vv>v>...>.v.>>....>.>>...>vv>>.v..>v.>.>>v....",
        "v...v.vvv.v..v>...>.>...v..v.vv..>.........vv.>vv.....v>v.v....>.v.v>>v>.>..v>>v>..>..v>.>v.v.v.v..v>>v..v..>...v.v.........>>v.>...v.v.v.>",
        ".>...v...v.vvv.>v.vv.>>>.v.v.vvv>.....v>v.v>....v.>>....>....v..v>.vvv..vvv..vv.v.v.v>.>.v>v..v>.v.>>..>.....v.>.>.v....>>>>.>vv>.v..vv>..v",
        ">>.v..v..v>v>..vv...>.v..v.>..vv.v.vv.>>v..vvv>>vv..>..v.v.v.vv>>..>v.>>.>...>v.>.v.>......v>..vv..>v...>...>...>.>>>v.>>..v.>....v.vv.v>.>",
        "....vv.......v.v.>.v>v.v...>...v>.v>.....v>.>v....>vv>>>>v.vv>>v...>..>>.>>...>>..vvvv..v>>>.>>v..>vv.>v>..v......>v...v>>.v..v.v.....>..>.",
        ">.v>>v..>>>..vv>.>>>..vv>vv.vv...>...vvvv..v.v>v..v.>v>....>..>.vv.vvv.>...>v.vv..v.v>>...>v>>..>v.vvv.vv.>>v......>.>.v>>..>>..v....>...v.",
        "vv.>>vv.....>.v...v.........>...>>>>>.>>....>vvv.>..v..>v>>....vvvv>v>>vv..>..>vv.>v..>>>.>.....v..v>>...>>v.>.>..>vv...v.v.>v..vv.>..v>>v.",
        "...v...>.v...v>.>>...>v>vvv...v>v.vvv>>..>v.......>...>.vvv.>vv>.vv....>vv.>v>.>.>....>v...>>.>.v....v>>v>>.>v>v.>>>>.>vvv>..v..>>v.vvv...>",
        ">.>>v.>.vv>.v>.>..>.>.v.v...v>..>>....v..>>v..>.v>v.......v.v.v>v..v>vvv.>>>.vv...>.>vvv>vv.....>>.vv..v>v.>>vv>.vv.v>.>>.vvv.>...vv.vv.v..",
        "..>v...v.v.....>v>>>>..>.>..>.v...>.>.>>..v.>v>.v>>v...>..>..v.v..>vvvv.>>.v>...>vvv...v...v....>..>.v>>>....v..>....vv.>v.>.v>v....v.vv.v."
};

static std::vector<std::string> input_test = {
        "v...>>.vv>",
        ".vv>>.vv..",
        ">>.>v>...v",
        ">>v>>.>.v.",
        "v>v.vv.v..",
        ">.>>..v...",
        ".vv..>.>v.",
        "v.v..>>v.v",
        "....v..v.>",

};

static auto &input = input_real;
//static auto& input = input_test;

void
try_next_east(int64_t x, int64_t y, const std::vector<std::string> &map_before, std::vector<std::string> &map_after) {
    auto next_x = x + 1;
    auto next_y = y;

    if (next_x == map_before.at(0).size()) {
        next_x = 0;
    }

    if (map_before.at(next_y).at(next_x) == '.') {
        map_after.at(y).at(x) = '.';
        map_after.at(next_y).at(next_x) = '>';
    }
}

void
try_next_south(int64_t x, int64_t y, const std::vector<std::string> &map_before, std::vector<std::string> &map_after) {
    auto next_x = x;
    auto next_y = y + 1;

    if (next_y == map_before.size()) {
        next_y = 0;
    }

    if (map_before.at(next_y).at(next_x) == '.') {
        map_after.at(y).at(x) = '.';
        map_after.at(next_y).at(next_x) = 'v';
    }
}

std::vector<std::string> go_east(const std::vector<std::string> &before) {
    auto after = before;
    for (int j = 0; j < before.size(); j++) {
        for (int i = 0; i < before.at(0).size(); i++) {
            if (before.at(j).at(i) == '>') {
                try_next_east(i, j, before, after);
            }
        }
    }
    return after;
}

std::vector<std::string> go_south(const std::vector<std::string> &before) {
    auto after = before;
    for (int j = 0; j < before.size(); j++) {
        for (int i = 0; i < before.at(0).size(); i++) {
            if (before.at(j).at(i) == 'v') {
                try_next_south(i, j, before, after);
            }
        }
    }
    return after;
}

int main() {

    auto state_before = input;
    auto state_after_east = input;
    auto state_after_south = input;
    for (int i = 0; i < INT_MAX; i++) {
        state_after_east = go_east(state_before);
        state_after_south = go_south(state_after_east);

        if (state_after_south == state_before) {
            std::cout << i + 1 << std::endl;
            break;
        }

        state_before = state_after_south;
    }

    return 0;
}
